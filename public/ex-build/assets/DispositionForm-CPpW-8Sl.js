import{G as U,p as v,o as P,s as w,v as j,c as l,a as r,f as x,u as S,i as $,q as B,d as c,b as e,e as p,h as O,w as I,t as m,k as b,m as _,F as h,H as y,j as L,l as M}from"./app-dLBOcVNJ.js";import{_ as F}from"./AuthenticatedLayout-CyZJui5o.js";import{l as N,a as E,r as q}from"./lodash-B-3U-dGu.js";import{_ as z,a as k}from"./InputLabel-OTQTgnDj.js";import{_ as A}from"./Pagination-DCv-RQuV.js";import"./_plugin-vue_export-helper-D0KVHBas.js";const H={__name:"TextareaInput",props:{modelValue:{type:String,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a,{expose:o}){const d=U(a,"modelValue"),i=v(null);return P(()=>{i.value.hasAttribute("autofocus")&&i.value.focus()}),o({focus:()=>i.value.focus()}),(u,f)=>w((r(),l("textarea",{class:"block w-full rounded-md bg-white px-3 py-1.5 text-base text-gray-900 outline outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline focus:outline-2 focus:-outline-offset-2 focus:outline-blue-600 sm:text-sm/6","onUpdate:modelValue":f[0]||(f[0]=g=>d.value=g),ref_key:"textarea",ref:i,rows:"4"},null,512)),[[j,d.value]])}},K={class:"bg-base-100 overflow-hidden shadow-md rounded-lg p-6"},G={class:"p-4 border border-base-300 rounded-lg mb-6 bg-base-200"},J={class:"font-bold text-lg"},Q={class:"text-sm"},W={class:"text-sm"},X={class:"text-sm"},Y={class:"mb-6"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},R={class:"p-4 border border-base-300 rounded-lg"},ee={class:"input input-bordered flex items-center gap-2 w-full mb-4"},te={class:"space-y-2 max-h-60 overflow-y-auto"},se=["onClick"],ie={key:0,class:"text-center text-sm text-gray-500"},oe={class:"p-4 border border-blue-400 bg-blue-50 rounded-lg"},ne={class:"font-bold mb-2"},ae={key:0,class:"space-y-2 max-h-96 overflow-y-auto"},le=["onClick"],re={key:1,class:"flex items-center justify-center h-full text-center"},de={class:"mt-6 flex items-center justify-end gap-x-6"},ue=["disabled"],ce={key:0,class:"loading loading-spinner"},ve=Object.assign({layout:F},{__name:"DispositionForm",props:{disposition:Object,letter:Object,users:Object,filters:Object,errors:Object},setup(a){const o=a,d=x(()=>!!o.disposition),i=S({_method:d.value?"PATCH":"POST",instruction:o.disposition?.instruction||"",recipients:o.disposition?.recipients.map(s=>s.id)||[]}),u=v(o.disposition?.recipients||[]),f=v(o.filters.search||""),g=x(()=>o.users.data.filter(s=>!u.value.some(t=>t.id===s.id))),V=s=>{u.value.some(t=>t.id===s.id)||(u.value.push(s),i.recipients.push(s.id))},D=s=>{u.value=u.value.filter(t=>t.id!==s.id),i.recipients=i.recipients.filter(t=>t!==s.id)};$(f,N.debounce(s=>{const t=d.value?route("dispositionIncomingLetter.modify",o.disposition.id):route("dispositionIncomingLetter.new",o.letter.id);B.get(t,{search:s},{preserveState:!0,replace:!0})},300));const C=()=>{const s=d.value?route("dispositionIncomingLetter.update",o.disposition.id):route("dispositionIncomingLetter.save",o.letter.id);i.post(s)};return(s,t)=>(r(),l(h,null,[c(p(O),{title:d.value?"Ubah Disposisi":"Buat Disposisi"},null,8,["title"]),e("div",K,[e("form",{onSubmit:I(C,["prevent"])},[e("div",G,[e("h3",J,m(d.value?"Ubah Disposisi untuk Surat":"Buat Disposisi untuk Surat"),1),e("p",Q,[t[2]||(t[2]=e("strong",null,"Nomor:",-1)),b(" "+m(a.letter.letter_number),1)]),e("p",W,[t[3]||(t[3]=e("strong",null,"Perihal:",-1)),b(" "+m(a.letter.subject),1)]),e("p",X,[t[4]||(t[4]=e("strong",null,"Pengirim:",-1)),b(" "+m(a.letter.sender),1)])]),e("div",Y,[c(z,{for:"instruction",value:"Instruksi / Catatan Disposisi",class:"font-bold"}),c(H,{id:"instruction",modelValue:p(i).instruction,"onUpdate:modelValue":t[0]||(t[0]=n=>p(i).instruction=n),class:"mt-1 block w-full",placeholder:"Tuliskan instruksi disposisi di sini...",rows:"4"},null,8,["modelValue"]),c(k,{message:a.errors.instruction,class:"mt-2"},null,8,["message"])]),e("div",Z,[e("div",R,[t[5]||(t[5]=e("h4",{class:"font-bold mb-2"},"Pilih Penerima",-1)),e("label",ee,[w(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>f.value=n),type:"text",class:"grow",placeholder:"Cari pegawai..."},null,512),[[j,f.value]]),c(p(E),{class:"size-5 text-gray-400"})]),e("div",te,[(r(!0),l(h,null,y(g.value,n=>(r(),l("div",{key:n.id,class:"flex justify-between items-center p-2 rounded-md hover:bg-base-200"},[e("span",null,m(n.name),1),e("button",{onClick:T=>V(n),type:"button",class:"btn btn-xs btn-outline btn-primary"},"Tambah",8,se)]))),128)),g.value.length===0?(r(),l("p",ie,m(a.users.data.length>0?"Semua pegawai yang cocok telah dipilih.":"Tidak ada data."),1)):_("",!0)]),c(A,{links:a.users.links,class:"mt-4"},null,8,["links"])]),e("div",oe,[e("h4",ne,"Penerima Terpilih ("+m(u.value.length)+")",1),u.value.length>0?(r(),l("div",ae,[(r(!0),l(h,null,y(u.value,n=>(r(),l("div",{key:n.id,class:"flex justify-between items-center p-2 rounded-md bg-white shadow-sm"},[e("span",null,m(n.name),1),e("button",{onClick:T=>D(n),type:"button",class:"btn btn-xs btn-ghost text-error"},[c(p(q),{class:"size-4"})],8,le)]))),128))])):(r(),l("div",re,t[6]||(t[6]=[e("p",{class:"text-sm text-gray-500"},[b("Belum ada penerima dipilih."),e("br"),b('Klik "Tambah" pada daftar di sebelah kiri.')],-1)])))])]),c(k,{message:a.errors.recipients,class:"mt-2"},null,8,["message"]),e("div",de,[c(p(M),{href:s.route("incomingLetter.index"),class:"btn btn-ghost"},{default:L(()=>t[7]||(t[7]=[b("Batal",-1)])),_:1,__:[7]},8,["href"]),e("button",{type:"submit",class:"btn text-white bg-blue-600 hover:bg-blue-700",disabled:p(i).processing},[p(i).processing?(r(),l("span",ce)):_("",!0),b(" "+m(d.value?"Perbarui Disposisi":"Kirim Disposisi"),1)],8,ue)])],32)])],64))}});export{ve as default};
