import{x as P,f as b,u as w,c,a as i,I as S,m as n,b as s,e as t,h as V,w as $,t as f,s as M,J as O,d as r,k as v,j as U,l as N,F}from"./app-dLBOcVNJ.js";import{_ as L}from"./AuthenticatedLayout-CyZJui5o.js";import{_ as h}from"./TextInput-CVtSF1iH.js";import{_ as p,a as g}from"./InputLabel-OTQTgnDj.js";import{_ as C,a as T}from"./DateInput-DRoi3Kgx.js";import{_ as B}from"./SelectInput-CKLdoSGI.js";import"./_plugin-vue_export-helper-D0KVHBas.js";const D={class:"bg-base-100 overflow-hidden shadow-md rounded-lg p-6"},K={key:0,class:"alert alert-error mb-4"},X={class:"space-y-12"},q={class:"border-b border-gray-900/10 pb-12"},A={class:"grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},E={key:0,class:"sm:col-span-4"},H={class:"label cursor-pointer gap-2"},I={key:1,class:"sm:col-span-4"},z={class:"mt-2"},J={class:"mt-6"},G={key:2,class:"sm:col-span-4"},Q={class:"alert alert-info"},R={key:3,class:"my-4"},W={class:"sm:col-span-4"},Y={class:"mt-2"},Z={class:"sm:col-span-4"},ee={class:"mt-2"},te={class:"sm:col-span-4"},se={class:"mt-2"},ae={class:"sm:col-span-4"},re={class:"mt-2"},le={key:0,class:"text-xs mt-1"},oe=["href"],ie={class:"mt-6 flex items-center justify-end gap-x-6"},ne=["disabled"],de={key:0,class:"loading loading-spinner"},fe=Object.assign({layout:L},{__name:"OutgoingLetterForm",props:{letter:Object,categories:Object,numberParts:Object,errors:Object},setup(m){const l=m,_=P(),y=b(()=>_.props.flash.error),d=b(()=>!!l.letter),k=b(()=>d.value?!!l.letter.is_archive_mode:!1),e=w({is_archive_mode:k.value,letter_number:l.letter?.letter_number||_.props.old?.letter_number||"",letter_date:l.letter?.letter_date||_.props.old?.letter_date||"",subject:l.letter?.subject||_.props.old?.subject||"",category_id:l.letter?.category_id||_.props.old?.category_id||Object.keys(l.categories)[0]||"",recipient:l.letter?.recipient||_.props.old?.recipient||"",attachment_file:null}),x=b(()=>{if(d.value||k.value||!e.category_id)return"";const u=l.categories[e.category_id],a=u?u.classification_code:"XXX";return`${String(l.numberParts.sequence).padStart(3,"0")}/${a}/${l.numberParts.unit_code}/${l.numberParts.roman_month}/${l.numberParts.year}`}),j=()=>{const u=l.letter?route("outgoingLetter.update",l.letter.id):route("outgoingLetter.save");e.post(u,{forceFormData:!0,preserveState:!0,onSuccess:()=>{e.reset()},headers:{"X-HTTP-Method-Override":l.letter?"PATCH":"POST"}})};return(u,a)=>(i(),c(F,null,[u.route().current("outgoingLetter.new")?(i(),S(t(V),{key:0,title:"Tambah Surat Keluar"})):n("",!0),u.route().current("outgoingLetter.modify")?(i(),S(t(V),{key:1,title:"Ubah Surat Keluar"})):n("",!0),s("div",D,[s("form",{onSubmit:$(j,["prevent"]),class:"mx-2"},[!d.value&&y.value?(i(),c("div",K,[s("span",null,f(y.value),1)])):n("",!0),s("div",X,[s("div",q,[s("div",A,[d.value?n("",!0):(i(),c("div",E,[s("label",H,[a[7]||(a[7]=s("span",{class:"label-text"},"Arsipkan Surat Lama (Input Manual)",-1)),M(s("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=o=>t(e).is_archive_mode=o),class:"checkbox checkbox-primary"},null,512),[[O,t(e).is_archive_mode]])])])),t(e).is_archive_mode||d.value?(i(),c("div",I,[s("div",z,[r(p,{for:"letter_number",value:"Nomor Surat"}),r(h,{id:"letter_number",ref:"letter_number",modelValue:t(e).letter_number,"onUpdate:modelValue":a[1]||(a[1]=o=>t(e).letter_number=o),type:"text",class:"mt-1 block w-full",placeholder:"Masukkan Nomor Surat"},null,8,["modelValue"]),r(g,{message:t(e).errors.letter_number,class:"mt-2"},null,8,["message"])]),s("div",J,[r(p,{for:"letter_date",value:"Tanggal Surat"}),r(C,{id:"letter_date",ref:"letter_date",modelValue:t(e).letter_date,"onUpdate:modelValue":a[2]||(a[2]=o=>t(e).letter_date=o),class:"mt-1 block w-full"},null,8,["modelValue"]),r(g,{message:t(e).errors.letter_date,class:"mt-2"},null,8,["message"])])])):n("",!0),!d.value&&!t(e).is_archive_mode?(i(),c("div",G,[s("div",Q,[s("span",null,[a[8]||(a[8]=v("Nomor Surat akan dibuat otomatis: ",-1)),s("strong",null,f(x.value),1)])])])):n("",!0),d.value?n("",!0):(i(),c("hr",R)),s("div",W,[s("div",Y,[r(p,{for:"category",value:"Kategori Surat"}),r(B,{class:"capitalize",modelValue:t(e).category_id,"onUpdate:modelValue":a[3]||(a[3]=o=>t(e).category_id=o),items:Object.values(m.categories),"item-value":"id","item-text":"name",placeholder:"Pilih Kategori"},null,8,["modelValue","items"]),r(g,{message:t(e).errors.category_id,class:"mt-2"},null,8,["message"])])]),s("div",Z,[s("div",ee,[r(p,{for:"subject",value:"Perihal / Subjek"}),r(h,{id:"subject",ref:"subject",modelValue:t(e).subject,"onUpdate:modelValue":a[4]||(a[4]=o=>t(e).subject=o),type:"text",class:"mt-1 block w-full",placeholder:"Masukkan Perihal Surat"},null,8,["modelValue"]),r(g,{message:t(e).errors.subject,class:"mt-2"},null,8,["message"])])]),s("div",te,[s("div",se,[r(p,{for:"recipient",value:"Penerima Surat"}),r(h,{id:"recipient",ref:"recipient",modelValue:t(e).recipient,"onUpdate:modelValue":a[5]||(a[5]=o=>t(e).recipient=o),type:"text",class:"mt-1 block w-full",placeholder:"Contoh: Kementerian Dalam Negeri"},null,8,["modelValue"]),r(g,{message:t(e).errors.recipient,class:"mt-2"},null,8,["message"])])]),s("div",ae,[s("div",re,[r(p,{for:"attachment_file",value:"Unggah Lampiran (PDF)"}),r(T,{id:"attachment_file",accept:".pdf,application/pdf","onUpdate:modelValue":a[6]||(a[6]=o=>t(e).attachment_file=o),class:"mt-1"}),m.letter&&m.letter.file_path?(i(),c("div",le,[a[9]||(a[9]=v(" File saat ini: ",-1)),s("a",{href:`/storage/${m.letter.file_path}`,target:"_blank",class:"text-primary hover:underline"},f(m.letter.file_path.split("/").pop()),9,oe)])):n("",!0),r(g,{message:t(e).errors.attachment_file,class:"mt-2"},null,8,["message"])])])])])]),s("div",ie,[r(t(N),{href:u.route("outgoingLetter.index"),class:"btn btn-ghost"},{default:U(()=>a[10]||(a[10]=[v("Batal",-1)])),_:1,__:[10]},8,["href"]),s("button",{type:"submit",class:"btn text-white bg-blue-600 hover:bg-blue-700",disabled:t(e).processing},[t(e).processing?(i(),c("span",de)):n("",!0),v(" "+f(d.value?"Update Surat Masuk":"Simpan Surat Masuk"),1)],8,ne)])],32)])],64))}});export{fe as default};
